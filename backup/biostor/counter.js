{"_id":"_design/counter","_rev":"4-8a120d78827116ed0a89900825756cde","language":"javascript","views":{"ip":{"map":"function(doc) {\n  if (doc.SERVER_ADDR) {\n    var id = doc.REQUEST_URI;\n    id = id.replace(/\\/reference\\//, '');\n    emit([id, doc.HTTP_CF_CONNECTING_IP], 1);\n  }\n}"},"user_agent":{"map":"function(doc) {\n  if (doc.HTTP_USER_AGENT) {\n    emit(doc.HTTP_USER_AGENT, 1);\n  }\n}"},"views":{"map":"function notabot(user_agent) {\n  var isbot = false;\n\n  if (user_agent.match(/biadu|bot|crawl|slurp|spider/i)) {\n    isbot = true;\n  }\n\n  return !isbot;\n}\n\n\nfunction(doc) {\n  if (doc.HTTP_USER_AGENT) {\n    if (notabot(doc.HTTP_USER_AGENT)) {\n      var id = doc.REQUEST_URI;\n      id = id.replace(/\\/reference\\//, '');\n      id = id.replace(/biostor\\//, '');\n      emit([id, doc.HTTP_CF_CONNECTING_IP], 1);\n    }\n  }\n}","reduce":"_sum"}}}
